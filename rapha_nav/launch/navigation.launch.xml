<launch version="0.1.1">

  <let name="param_file" value="$(find-pkg-share rapha_nav)/config/navigation.yaml" />

  <node_container namespace=""
    name="navigation_container"
    pkg="rclcpp_components"
    exec="component_container_isolated">
    <param from="$(var param_file)" />
<!--
    <composable_node name="amcl_node"
      pkg="nav2_amcl"
      plugin="nav2_amcl::AmclNode">
      <param from="$(var param_file)" />
    </composable_node>
-->    
    <composable_node name="planner_server"
      pkg="nav2_planner"
      plugin="nav2_planner::PlannerServer">
      <extra_arg name="use_intra_process_comms" value="true" />
      <param from="$(var param_file)" />
    </composable_node>

    <composable_node name="controller_server"
      pkg="nav2_controller"
      plugin="nav2_controller::ControllerServer">
      <extra_arg name="use_intra_process_comms" value="true" />
      <param from="$(var param_file)" />
    </composable_node>

    <composable_node name="bt_navigator"
      pkg="nav2_bt_navigator"
      plugin="nav2_bt_navigator::BtNavigator">
      <param name="default_nav_to_pose_bt_xml"
        value="$(find-pkg-share rapha_nav)/config/behavior_trees/navigate_w_replanning_time.xml" />
      <param name="default_nav_through_poses_bt_xml"
        value="$(find-pkg-share rapha_nav)/config/behavior_trees/navigate_w_replanning_time.xml" />
      <param from="$(var param_file)" />
    </composable_node>

    <composable_node name="waypoint_follower"
      pkg="nav2_waypoint_follower"
      plugin="nav2_waypoint_follower::WaypointFollower">
      <param from="$(var param_file)" />
    </composable_node>

    <composable_node name="lifecycle_manager_navigation"
      pkg="nav2_lifecycle_manager"
      plugin="nav2_lifecycle_manager::LifecycleManager">
      <extra_arg name="use_intra_process_comms" value="true" />
      <param from="$(var param_file)" />
    </composable_node>
    <!--
    <composable_node name="velocity_smoother"
      pkg="nav2_velocity_smoother"
      plugin="nav2_velocity_smoother::VelocitySmoother">
      <param from="$(var param_file)" />
    </composable_node>
    -->
  </node_container>

</launch>