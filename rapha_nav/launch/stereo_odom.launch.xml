<launch>
    <!--Rtabmap odom nodes outside of oak launch-->
    <node name="static_tf_publisher" pkg="tf2_ros" exec="static_transform_publisher" args="0 0 0 0 0 3.14 base_link imu"/>

    <node_container namespace=""
        name="stereo_odom_container"
        pkg="rclcpp_components"
        exec="component_container_isolated">
        <composable_node name="stereo_odometry"
            pkg="rtabmap_odom"
            plugin="rtabmap_odom::StereoOdometry">
            <param name="frame_id" value="base_footprint" />
            <param name="publish_tf" value="false" />
            <param name="approx_sync" value="true" />
            <param name="wait_imu_to_init" value="true" />
            <!--<param name="initial_pose" value="0 0 0 0 0 3.14159" />-->

            <remap from="left/image_rect" to="/oak/left/image_rect" />
            <remap from="right/image_rect" to="/oak/right/image_rect" />
            <remap from="left/camera_info" to="/oak/left/camera_info" />
            <remap from="right/camera_info" to="/oak/right/camera_info" />
            <remap from="imu" to="/controller/imu" />
        </composable_node>

        <composable_node name="right_rectify_mono_node"
            pkg="image_proc"
            plugin="image_proc::RectifyNode">
            <remap from="image" to="/oak/right/image_raw" />
            <remap from="camera_info" to="/oak/right/camera_info" />
            <remap from="image_rect" to="/oak/right/image_rect" />
            <remap from="image_rect/compressed" to="/oak/right/image_rect/compressed" />
            <remap from="image_rect/compressedDepth" to="/oak/right/image_rect/compressedDepth" />
            <remap from="image_rect/theora" to="/oak/right/image_rect/theora" />
        </composable_node>

        <composable_node name="left_rectify_mono_node"
            pkg="image_proc"
            plugin="image_proc::RectifyNode">
            <remap from="image" to="/oak/left/image_raw" />
            <remap from="camera_info" to="/oak/left/camera_info" />
            <remap from="image_rect" to="/oak/left/image_rect" />
            <remap from="image_rect/compressed" to="/oak/left/image_rect/compressed" />
            <remap from="image_rect/compressedDepth" to="/oak/left/image_rect/compressedDepth" />
            <remap from="image_rect/theora" to="/oak/left/image_rect/theora" />
        </composable_node>
    </node_container>
</launch>