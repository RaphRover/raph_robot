<launch>
  <include file="$(find-pkg-share leo2_description)/launch/state_publisher.launch.xml" />
  <include file="$(find-pkg-share leo2_oak)/launch/oak_camera.launch.py" />

  <node name="vel_to_ackermann_converter" pkg="leo2_nav" exec="cmd_vel_to_ackermann_drive" >
    <param name="wheelbase" value="0.38"/>
  </node>

  <node name="trajectory_path" pkg="leo2_nav" exec="trajectory_path" >
    <param name="frame_id" value="odom"/>
    <remap from="/odom" to="/controller/odom"/>
  </node>

  <!--<node name="static_imu_tf_publisher" pkg="tf2_ros" exec="static_transform_publisher" args="0 0 0 0 0 3.14 base_link imu"/>-->
  <!--TODO Calculate laser_link -> oak_base_link tf and delete odom tf-->
  <!--TODO maybe change oak camera height in urdf or maybe nav2 parameters are enough-->
  <node name="static_tf_publisher" pkg="tf2_ros" exec="static_transform_publisher" args="0 0 0.15 3.14159 0 0 oak_base_link laser_link"/>
  <node name="static_map_tf_publisher" pkg="tf2_ros" exec="static_transform_publisher" args="0 0 0 0 0 0 map odom"/>
  <node name="static_odom_tf_publisher" pkg="tf2_ros" exec="static_transform_publisher" args="0 0 0 0 0 0 odom base_footprint"/>

  <node name="rplidar_node" pkg="rplidar_ros" exec="rplidar_composition">
    <param name="frame_id" value="laser_link" />
    <param name="angle_compensate" value="true" />
    <param name="serial_baudrate" value="115200" /> <!--TODO UpBoard may have a different baudrate-->
  </node>

  <node name="slam_toolbox_node" pkg="slam_toolbox" exec="async_slam_toolbox_node">
    <param name="minimum_travel_distance" value="0.3" />
    <param name="minimum_travel_heading" value="0.3" />
    <param name="map_update_interval" value="1.0" />
    <param name="loop_search_maximum_distance" value="0.5" />
    <param name="enable_interactive_mode" value="false" />
    <param name="max_laser_range" value="12.0" />
  </node>
</launch>
